name: Run aengbot

on:
  schedule:
    - cron: "*/15 8-22 * * *"
  workflow_dispatch:    
      
jobs:
  RunAengbot:
    runs-on: ubuntu-latest
    steps:
      - name: Wake up app
        uses: fjogeleit/http-request-action@main
        with:
          retry: 5
          retryWait: 3000
          url: 'https://aenbot-api.azurewebsites.net/aengbot/wakeUp'
          method: 'GET'
          customHeaders: '{"X_API_KEY": "${{ secrets.AENGBOT_API_KEY }}"}'

      - name: Run app
        uses: fjogeleit/http-request-action@main
        with:
          url: 'https://aenbot-api.azurewebsites.net/aengbot/trigger'
          method: 'GET'
          password: ${{ secrets.AWX_PASSWORD }}
          customHeaders: '{"X_API_KEY": "${{ secrets.AENGBOT_API_KEY }}"}'